# Diploma

## Данный проект включает в себя модуль агрегации, сверки и фискализации платежей для IT-платформы зарядки электротранспорта TOUCH города Волгограда и Волжского

---

### Модуль работает с банком ПСБ для совершения рекуррентных платежей по следующему принципу:

### На вход контроллера Bank приходит информация о оплате в виде JSON POST-запросом. Набор необходимых полей:

* "Сумма платежа, Р"
* "Внутренний идентификатор платежа"
* "Описание платежа"
* "Компания-владелец станции"
* "Email клиента"
* "Email владельца станции"
* "Идентификатор резерва или зарядной сессии"
* "Телефон клиента"
* "Номер устройства"
* "Номер ТСП"
* "Уникальный идентификатор операции на ПШ"
* "Уникальный идентификатор операции"

### Набор полей синхронного ответа модуля
* "DESC" - описание операции
* "TIMESTAMP" - время операции в формате YYYYMMDDHHMMSS
* StatusCode - HTTP-код

### В случае успешной оплаты к вышеуказанному набору полей добавляется
* "AMOUNT" - сумма списания рекуррентного платежа
* "ORDER" - внутренний идентификатор платежа
* "RC" - код ответа банка
* "RCTEXT" - текст ответа банка
* "CARD" - номер карты клиента

### Если заправочная сессия завершается (сумма операции != 50), набор полей дополняется уже другим набором полей:
* "TouchAmount" - действительная сумма зарядной сессии
* "BankAmount" - успешно списанная банком сумма зарядной сессии
* "RC" - код ответа банка
* "RCTEXT" - текст ответа банка
* "CARD" - номер карты клиента 